using DentalClinic.Models;
using DentalClinic.Services;
using MailKit.Net.Smtp;
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Linq;
using System.Net;
using System.Net.Mail;
using System.Threading;
using System.Threading.Tasks;
using System.Web;

namespace DentalClinic.Providers
{
    public class SMSProvider
    {
        //1 - nhắc nhở, 2- đặt lịch thành công
        public static bool SendOTPViaEmail(string email, string name, string code, int day, int month, int year, int hour, int minute,  string title, string message)
        {
            System.Net.Mail.SmtpClient clientDetails = new System.Net.Mail.SmtpClient();
            clientDetails.Port = 587;
            clientDetails.Host = "smtp.gmail.com";
            clientDetails.EnableSsl = true;
            clientDetails.DeliveryMethod = SmtpDeliveryMethod.Network;
            clientDetails.UseDefaultCredentials = false;
            clientDetails.Credentials = new NetworkCredential("thaovu13092001@gmail.com", "sehhnofdtuxvidol");

            //Message Details
            MailMessage mailDetails = new MailMessage();
            mailDetails.From = new MailAddress("thaovu13092001@gmail.com");
            mailDetails.To.Add(email);
            mailDetails.Subject = "[Nha khoa Phương Thảo] " + title;
            mailDetails.IsBodyHtml = true;
            //string path = HttpContext.Current.Server.MapPath("~/Content/files/emailtemplates/Confirm.txt");
            //string body = System.IO.File.ReadAllText(path);
            mailDetails.Body = "<head><link href=\"https://fonts.googleapis.com/css?family=Exo\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Roboto\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Open Sans\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Google Sans\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Muli\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Montserrat\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Lato\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Raleway\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Nunito\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Merriweather\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Source Serif Pro\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Times New Roman\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Playfair Display\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Pacifico\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Caveat\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Courgette\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Lobster\" rel=\"stylesheet\">\n<style>\n        @media only screen and (min-width: 640px){\n            table.ai-email-section-3>tbody>tr>td>div,\n            table.ai-email-section-2>tbody>tr>td>div,\n            table.ai-email-section-1>tbody>tr>td>div,\n            table.ai-email-section-12>tbody>tr>td>div,\n            table.ai-email-section-21>tbody>tr>td>div{\n                display: table-cell !important;\n                width: auto !important;\n            }\n            \n            table.ai-email-section-3>tbody>tr>td>div{\n                max-width: 200px !important;\n            }\n\n            table.ai-email-section-2>tbody>tr>td>div{\n                max-width: 300px !important;\n            }\n        }\n    </style>\n    </head><!--[if gte mso 9]>\n    <v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n      \n        <v:fill type=\"tile\" size=\"100%,100%\" color=\"#EAF0F6\"/>\n      \n    </v:background><!--><body><div id=\"wrapper\" class=\"gjs-dashed\" style=\"box-sizing: border-box;\"><table id=\"ifrj\" class=\"ai-email-section-1\" style=\"box-sizing: border-box; max-height: 100%; min-height: 46px; text-align: center; background-size: cover; background-color: rgba(236, 245, 250, 0.8); margin: 0px; padding: 0px; background-image: none; background-position: center center;\" width=\"100%\" align=\"center\" bgcolor=\"rgba(236,245,250,0.8)\" background=\"none\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" background-color=\"#ecf5fa\" background-image=\"none\"><tbody style=\"box-sizing: border-box;\"><tr><td align=\"center\" valign=\"top\"><!--[if (gte mso 9)|(IE)]>            <table width=\"588\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" style=\"vertical-align: top;\">            <tbody>              <tr>            <![endif]--><!--[if (gte mso 9)|(IE)]>                                            <td width=\"588px\" align=\"center\" valign=\"top\" style=\"background-color:#e4f2fd;\">                                    <![endif]-->                                    <div style=\"display:inline-block;vertical-align:top;\">                                        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" align=\"left\">                                            <tbody><tr><td align=\"center\" valign=\"top\" width=\"100%\"><table id=\"iz5zl\" class=\"ai-email-image-v2\" style=\"width: 100%; margin: 0; box-sizing: border-box; justify-content: center; cursor: pointer; text-align: center; overflow: hidden; padding: 16px 0px 16px 0px;\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody><tr><td align=\"center\" style=\"vertical-align: top;\"><table class=\"ai-email-image\" style=\"display:inline-block; float:none\"><tbody><tr><td style=\"vertical-align: top;text-align: center;\"><img src=\"https://testaimkt.misacdn.net/app/594lxly7/attachment/33657e39-862c-4384-9a38-db051c45459d.png\" lock-size=\"\" id=\"iyj6f\" oldwidth=\"555\" oldheight=\"70\" style=\"box-sizing: border-box; max-width: 100%; width: 241.4px; height: auto;\" width=\"241.4\"></td></tr></tbody></table></td></tr></tbody></table><table id=\"i3zai\" class=\"ai-email-header\" style=\"box-sizing: border-box; width: 100%; margin: 0; font-size: 30px; padding: 16px 16px 16px 16px; font-family: Arial;\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody style=\"text-align: center; min-height: 17px;\"><tr style=\"text-align: center; min-height: 17px;\"><td align=\"center\" width=\"100%\" style=\"text-align: center; min-height: 17px; vertical-align: top; width: 588px;\">NHA KHOA PHƯƠNG THẢO</td></tr></tbody></table><table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" id=\"ib36w\" class=\"ai-email-line\" style=\"box-sizing: border-box; text-align: center; width: 100%;\" align=\"center\"><tbody><tr align=\"center\" id=\"ihspt\" class=\"divider-wrapper\" style=\"box-sizing: border-box; width: 100%;\"><td width=\"100%\" id=\"ielfd\" class=\"aim-divider-td-wrapper\" style=\"box-sizing: border-box; padding: 0px 0px 16px; width: 100%; vertical-align: top;\"><table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" id=\"i08um\" style=\"box-sizing: border-box; border-spacing: 0; position: relative; top: -1px; min-width: 20px; max-width: 100%; width: 100%;\"><tbody><tr width=\"100%\" id=\"ioqry\" style=\"box-sizing: border-box; width: 100%;\"><td id=\"icsmx\" class=\"divider-left\" style=\"box-sizing: border-box; height: 0px; padding: 0px; vertical-align: top;\" height=\"0\"></td><td width=\"50%\" id=\"igetg\" class=\"divider-center\" style=\"box-sizing: border-box; border-top: 4.6px solid rgb(234, 65, 85); height: 2px; min-height: 2px; width: 50%; opacity: 1; padding: 0px; vertical-align: top;\" height=\"2\"></td><td id=\"ipahb\" class=\"divider-right\" style=\"box-sizing: border-box; padding: 0px; height: 0px; vertical-align: top;\" height=\"0\"></td></tr></tbody></table></td></tr></tbody></table><table class=\"ai-email-text\" id=\"i2jgi\" style=\"box-sizing: border-box; width: 100%; margin: 0; font-family: Arial; padding: 20px 16px 50px 16px; word-break: break-word; font-size: 16px;\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody style=\"text-align: center; min-height: 17px;\"><tr style=\"text-align: center; min-height: 17px;\"><td align=\"center\" width=\"100%\" style=\"text-align: center; min-height: 17px; vertical-align: top; width: 588px;\"><span style=\"box-sizing: border-box; font-size: 20px; text-align: center; min-height: 17px;\"><strong style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">Xin chào {{Name}}!</strong></span><br style=\"box-sizing: border-box; text-align: center; min-height: 17px;\"><br style=\"box-sizing: border-box; text-align: center; min-height: 17px;\"><strong style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">Phòng khám nha khoa Phương Thảo đã tiếp nhận lịch hẹn của bạn.</strong><br style=\"box-sizing: border-box; text-align: center; min-height: 17px;\"><br style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">Thông tin lịch hẹn:<br style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">Mã lịch hẹn: [<strong style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">{{Code}}</strong>]<br style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">Ngày hẹn: {{Day}}/{{Month}}/{{Year}}<br style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">Giờ hẹn: {{Hour}}:{{Minute}}<br style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">Vui lòng chú ý thời gian và đến đúng giờ. Chúng tôi rất mong được tiếp đón bạn tại phòng khám của chúng tôi.<br style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">Trân trọng!</td></tr></tbody></table><table class=\"ai-email-header\" id=\"isec7\" style=\"box-sizing: border-box; width: 100%; margin: 0; font-size: 30px; padding: 0px 0px 0px 0px; font-family: Arial;\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody style=\"text-align: center; min-height: 17px;\"><tr style=\"text-align: center; min-height: 17px;\"><td align=\"center\" width=\"100%\" style=\"text-align: center; min-height: 17px; vertical-align: top; width: 588px;\"></td></tr></tbody></table></td></tr></tbody></table></div><!--[if (gte mso 9)|(IE)]> </td><![endif]-->            <!--[if (gte mso 9)|(IE)]>            </tr></tbody>            </table>          <![endif]-->          </td></tr></tbody></table><table ondragstart=\"return false;\" id=\"ismh\" class=\"ai-email-footer\" style=\"box-sizing: border-box; max-height: 100%; min-height: 46px; width: 100%; padding: 16px; margin: 0px; text-align: center; background-size: auto; background-repeat: no-repeat; background-color: rgb(255, 255, 255); font-family: Arial; font-size: 13px;\" width=\"100%\" align=\"center\" bgcolor=\"rgba(255,255,255,255)\"><tbody style=\"box-sizing: border-box;\"><tr id=\"ig7i\" class=\"footer-company-detail\" style=\"box-sizing: border-box; width: 100%; height: 100%; min-height: auto;\"><td style=\"box-sizing: border-box; vertical-align: top;\"><div id=\"i0ok\" class=\"footer-company-name\" style=\"box-sizing: border-box; width: 100%; margin-top: 6px; margin-bottom: 6px;\">Nha Khoa Phương Thảo</div><div id=\"i7y5j\" class=\"footer-company-address\" style=\"box-sizing: border-box; width: 100%; margin-top: 6px; margin-bottom: 6px;\"><span class=\"footer-company-address-detail\" style=\"box-sizing: border-box;\">Số 16, ngách 2, ngõ 343, phố Đội Cấn, P. Liễu Giai</span><span class=\"footer-company-address-district\" style=\"box-sizing: border-box;\">, Quận Ba Đình</span><span class=\"footer-company-address-city\" style=\"box-sizing: border-box;\">, Hà Nội</span><span class=\"footer-company-address-country\" style=\"box-sizing: border-box;\">, Việt Nam</span></div><div id=\"iwr7d\" class=\"footer-company-phone\" style=\"box-sizing: border-box; width: 100%; margin-top: 6px; margin-bottom: 6px;\">0365186564</div><a href=\"https://nhakhoaphuongthao.vn/\" target=\"_blank\" id=\"i4o3m\" class=\"footer-company-url\" style=\"box-sizing: border-box; color: rgb(0, 0, 0); width: 100%; margin: 0px; text-decoration: none;\">https://nhakhoaphuongthao.vn/</a><div id=\"iebau\" class=\"footer-company-email\" style=\"box-sizing: border-box; width: 100%; margin-top: 6px; margin-bottom: 6px;\"></div><div id=\"i99jl\" class=\"footer-company-zip-code\" style=\"box-sizing: border-box; width: 100%; margin-top: 6px; margin-bottom: 6px;\"></div></td></tr><tr id=\"ikpzr\" style=\"box-sizing: border-box; width: 100%; height: 100%; min-height: auto;\"><td style=\"box-sizing: border-box; vertical-align: top;\"><table id=\"ieqy4\" class=\"footer-company-manager\" style=\"box-sizing: border-box; margin: 0 auto; color: #666666; font-family: Arial; font-weight: normal; font-size: 13px; font-style: normal; position: relative; left: 0; width: fit-content; float: none;\"><tbody><tr><td style=\"vertical-align: top;\"><table href=\"https://test.ladizone.com/aimkt/email/unsubscribe?infor=[url_verify_user]\" target=\"_blank\" ondragstart=\"return false;\" id=\"ips88\" class=\"footer-company-manager-unsubscribe footer-unsubscribe\" style=\"box-sizing: border-box; width: fit-content; margin: 0 12px; display: unset; text-decoration: underline; color: #7fbdf9ff; font-size: 13px;\"><tbody><tr><td style=\"padding: 0px; vertical-align: top; white-space: nowrap; word-break: normal; border-collapse: collapse;\"><a href=\"https://test.ladizone.com/aimkt/email/unsubscribe?infor=[url_verify_user]\" target=\"_blank\" ondragstart=\"return false;\" id=\"ips88\" class=\"footer-company-manager-unsubscribe footer-unsubscribe\" style=\"box-sizing: border-box; width: fit-content; margin: 0px; display: unset; text-decoration: underline; color: rgb(127, 189, 249); font-size: 13px; white-space: nowrap; word-break: normal; border-collapse: collapse;\">Hủy đăng ký</a></td></tr></tbody></table></td><td style=\"vertical-align: top;\"><table href=\"https://test.ladizone.com/aimkt/email/category?infor=[url_verify_user]\" target=\"_blank\" ondragstart=\"return false;\" id=\"ii33c\" class=\"footer-company-manager-categoty footer-unsubscribe\" style=\"box-sizing: border-box; width: fit-content; margin: 0 12px; display: none; text-decoration: underline; color: #7fbdf9ff; font-size: 13px;\"><tbody><tr><td style=\"padding: 0px; vertical-align: top; white-space: nowrap; word-break: normal; border-collapse: collapse;\"><a href=\"https://test.ladizone.com/aimkt/email/category?infor=[url_verify_user]\" target=\"_blank\" ondragstart=\"return false;\" id=\"ii33c\" class=\"footer-company-manager-categoty footer-unsubscribe\" style=\"box-sizing: border-box; width: fit-content; margin: 0px; display: none; text-decoration: underline; color: rgb(127, 189, 249); font-size: 13px; white-space: nowrap; word-break: normal; border-collapse: collapse;\">Quản lý nhận tin</a></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></div><style>@media only screen and (min-width: 640px) {  table.ai-email-section-3>tbody>tr>td>div,table.ai-email-section-2>tbody>tr>td>div,table.ai-email-section-1>tbody>tr>td>div,table.ai-email-section-12>tbody>tr>td>div,table.ai-email-section-21>tbody>tr>td>div {    display: table-cell !important;    width: auto !important;  }  table.ai-email-section-3>tbody>tr>td>div {    max-width: 200px !important;  }  table.ai-email-section-2>tbody>tr>td>div {    max-width: 300px !important;  }}</style><!--[endif]----></body>";
            
            mailDetails.Body = mailDetails.Body.Replace("{{Code}}", code);
            mailDetails.Body = mailDetails.Body.Replace("{{Name}}", name);
            mailDetails.Body = mailDetails.Body.Replace("{{Day}}", day.ToString().PadLeft(2, '0'));
            mailDetails.Body = mailDetails.Body.Replace("{{Month}}", month.ToString().PadLeft(2, '0'));
            mailDetails.Body = mailDetails.Body.Replace("{{Year}}", year.ToString());
            mailDetails.Body = mailDetails.Body.Replace("{{Hour}}", hour.ToString().PadLeft(2, '0'));
            mailDetails.Body = mailDetails.Body.Replace("{{Minute}}", minute.ToString().PadLeft(2, '0'));
            //mailDetails.Body = body;
            clientDetails.Send(mailDetails);
            return true;
        }
        public static bool SendOTPViaEmailRemind(string email, string name, string code, int day, int month, int year, int hour, int minute, string remind, string title, string message)
        {
            System.Net.Mail.SmtpClient clientDetails = new System.Net.Mail.SmtpClient();
            clientDetails.Port = 587;
            clientDetails.Host = "smtp.gmail.com";
            clientDetails.EnableSsl = true;
            clientDetails.DeliveryMethod = SmtpDeliveryMethod.Network;
            clientDetails.UseDefaultCredentials = false;
            clientDetails.Credentials = new NetworkCredential("thaovu13092001@gmail.com", "sehhnofdtuxvidol");

            //Message Details
            MailMessage mailDetails = new MailMessage();
            mailDetails.From = new MailAddress("thaovu13092001@gmail.com");
            mailDetails.To.Add(email);
            mailDetails.Subject = "[Nha khoa Phương Thảo] " + title;
            mailDetails.IsBodyHtml = true;
            //string path = HttpContext.Current.Server.MapPath("~/Content/files/emailtemplates/Confirm.txt");
            //string body = System.IO.File.ReadAllText(path);

            mailDetails.Body = "<head><link href=\"https://fonts.googleapis.com/css?family=Exo\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Roboto\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Open Sans\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Google Sans\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Muli\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Montserrat\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Lato\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Raleway\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Nunito\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Merriweather\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Source Serif Pro\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Times New Roman\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Playfair Display\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Pacifico\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Caveat\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Courgette\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css?family=Lobster\" rel=\"stylesheet\">\n<style>\n        @media only screen and (min-width: 640px){\n            table.ai-email-section-3>tbody>tr>td>div,\n            table.ai-email-section-2>tbody>tr>td>div,\n            table.ai-email-section-1>tbody>tr>td>div,\n            table.ai-email-section-12>tbody>tr>td>div,\n            table.ai-email-section-21>tbody>tr>td>div{\n                display: table-cell !important;\n                width: auto !important;\n            }\n            \n            table.ai-email-section-3>tbody>tr>td>div{\n                max-width: 200px !important;\n            }\n\n            table.ai-email-section-2>tbody>tr>td>div{\n                max-width: 300px !important;\n            }\n        }\n    </style>\n    </head><!--[if gte mso 9]>\n    <v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n      \n        <v:fill type=\"tile\" size=\"100%,100%\" color=\"#EAF0F6\"/>\n      \n    </v:background><!--><body><div id=\"wrapper\" class=\"gjs-dashed\" style=\"box-sizing: border-box;\"><table id=\"ifrj\" class=\"ai-email-section-1\" style=\"box-sizing: border-box; max-height: 100%; min-height: 46px; text-align: center; background-size: cover; background-color: rgba(236, 245, 250, 0.8); margin: 0px; padding: 0px; background-image: none; background-position: center center;\" width=\"100%\" align=\"center\" bgcolor=\"rgba(236,245,250,0.8)\" background=\"none\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" background-color=\"#ecf5fa\" background-image=\"none\"><tbody style=\"box-sizing: border-box;\"><tr><td align=\"center\" valign=\"top\"><!--[if (gte mso 9)|(IE)]>            <table width=\"588\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" style=\"vertical-align: top;\">            <tbody>              <tr>            <![endif]--><!--[if (gte mso 9)|(IE)]>                                            <td width=\"588px\" align=\"center\" valign=\"top\" style=\"background-color:#e4f2fd;\">                                    <![endif]-->                                    <div style=\"display:inline-block;vertical-align:top;\">                                        <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" align=\"left\">                                            <tbody><tr><td align=\"center\" valign=\"top\" width=\"100%\"><table id=\"iz5zl\" class=\"ai-email-image-v2\" style=\"width: 100%; margin: 0; box-sizing: border-box; justify-content: center; cursor: pointer; text-align: center; overflow: hidden; padding: 16px 0px 16px 0px;\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody><tr><td align=\"center\" style=\"vertical-align: top;\"><table class=\"ai-email-image\" style=\"display:inline-block; float:none\"><tbody><tr><td style=\"vertical-align: top;text-align: center;\"><img src=\"https://testaimkt.misacdn.net/app/594lxly7/attachment/33657e39-862c-4384-9a38-db051c45459d.png\" lock-size=\"\" id=\"iyj6f\" oldwidth=\"555\" oldheight=\"70\" style=\"box-sizing: border-box; max-width: 100%; width: 241.4px; height: auto;\" width=\"241.4\"></td></tr></tbody></table></td></tr></tbody></table><table id=\"i3zai\" class=\"ai-email-header\" style=\"box-sizing: border-box; width: 100%; margin: 0; font-size: 30px; padding: 16px 16px 16px 16px; font-family: Arial;\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody style=\"text-align: center; min-height: 17px;\"><tr style=\"text-align: center; min-height: 17px;\"><td align=\"center\" width=\"100%\" style=\"text-align: center; min-height: 17px; vertical-align: top; width: 588px;\">NHA KHOA PHƯƠNG THẢO</td></tr></tbody></table><table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" id=\"ib36w\" class=\"ai-email-line\" style=\"box-sizing: border-box; text-align: center; width: 100%;\" align=\"center\"><tbody><tr align=\"center\" id=\"ihspt\" class=\"divider-wrapper\" style=\"box-sizing: border-box; width: 100%;\"><td width=\"100%\" id=\"ielfd\" class=\"aim-divider-td-wrapper\" style=\"box-sizing: border-box; padding: 0px 0px 16px; width: 100%; vertical-align: top;\"><table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" id=\"i08um\" style=\"box-sizing: border-box; border-spacing: 0; position: relative; top: -1px; min-width: 20px; max-width: 100%; width: 100%;\"><tbody><tr width=\"100%\" id=\"ioqry\" style=\"box-sizing: border-box; width: 100%;\"><td id=\"icsmx\" class=\"divider-left\" style=\"box-sizing: border-box; height: 0px; padding: 0px; vertical-align: top;\" height=\"0\"></td><td width=\"50%\" id=\"igetg\" class=\"divider-center\" style=\"box-sizing: border-box; border-top: 4.6px solid rgb(234, 65, 85); height: 2px; min-height: 2px; width: 50%; opacity: 1; padding: 0px; vertical-align: top;\" height=\"2\"></td><td id=\"ipahb\" class=\"divider-right\" style=\"box-sizing: border-box; padding: 0px; height: 0px; vertical-align: top;\" height=\"0\"></td></tr></tbody></table></td></tr></tbody></table><table id=\"i3e53\" class=\"ai-email-text\" style=\"box-sizing: border-box; width: 100%; margin: 0; font-family: Arial; padding: 20px 16px 50px 16px; word-break: break-word; font-size: 16px;\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody style=\"text-align: center; min-height: 17px;\"><tr style=\"text-align: center; min-height: 17px;\"><td align=\"center\" width=\"100%\" style=\"text-align: center; min-height: 17px; vertical-align: top; width: 588px;\"><h1 style=\"box-sizing: border-box; text-align: center; min-height: 17px;\"><span style=\"box-sizing: border-box; font-size: 20px; text-align: center; min-height: 17px;\"><strong style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">Xin chào {{Name}}!</strong></span></h1><h2 style=\"box-sizing: border-box; text-align: center; min-height: 17px;\"><span style=\"box-sizing: border-box; font-size: 16px; text-align: center; min-height: 17px;\">Phòng khám nha khoa Phương Thảo nhắc nhở lịch khám.</span></h2><div style=\"box-sizing: border-box; text-align: center; min-height: 17px;\"><br style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">Lịch hẹn [<strong style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">{{Code}}</strong>] của bạn được đặt vào ngày&nbsp;{{Day}}/{{Month}}/{{Year}}<br style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">lúc&nbsp;{{Hour}}:{{Minute}} còn {{Remind}} tới hẹn.</div>Vui lòng chú ý thời gian và đến đúng giờ. Chúng tôi rất mong được tiếp đón bạn tại phòng khám của chúng tôi.<br style=\"box-sizing: border-box; text-align: center; min-height: 17px;\">Trân trọng!</td></tr></tbody></table><table class=\"ai-email-header\" id=\"isec7\" style=\"box-sizing: border-box; width: 100%; margin: 0; font-size: 30px; padding: 0px 0px 0px 0px; font-family: Arial;\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tbody style=\"text-align: center; min-height: 17px;\"><tr style=\"text-align: center; min-height: 17px;\"><td align=\"center\" width=\"100%\" style=\"text-align: center; min-height: 17px; vertical-align: top; width: 588px;\"></td></tr></tbody></table></td></tr></tbody></table></div><!--[if (gte mso 9)|(IE)]> </td><![endif]-->            <!--[if (gte mso 9)|(IE)]>            </tr></tbody>            </table>          <![endif]-->          </td></tr></tbody></table><table ondragstart=\"return false;\" id=\"ismh\" class=\"ai-email-footer\" style=\"box-sizing: border-box; max-height: 100%; min-height: 46px; width: 100%; padding: 16px; margin: 0px; text-align: center; background-size: auto; background-repeat: no-repeat; background-color: rgb(255, 255, 255); font-family: Arial; font-size: 13px;\" width=\"100%\" align=\"center\" bgcolor=\"rgba(255,255,255,255)\"><tbody style=\"box-sizing: border-box;\"><tr id=\"ig7i\" class=\"footer-company-detail\" style=\"box-sizing: border-box; width: 100%; height: 100%; min-height: auto;\"><td style=\"box-sizing: border-box; vertical-align: top;\"><div id=\"i0ok\" class=\"footer-company-name\" style=\"box-sizing: border-box; width: 100%; margin-top: 6px; margin-bottom: 6px;\">Nha Khoa Phương Thảo</div><div id=\"i7y5j\" class=\"footer-company-address\" style=\"box-sizing: border-box; width: 100%; margin-top: 6px; margin-bottom: 6px;\"><span class=\"footer-company-address-detail\" style=\"box-sizing: border-box;\">Số 16, ngách 2, ngõ 343, phố Đội Cấn, P. Liễu Giai</span><span class=\"footer-company-address-district\" style=\"box-sizing: border-box;\">, Quận Ba Đình</span><span class=\"footer-company-address-city\" style=\"box-sizing: border-box;\">, Hà Nội</span><span class=\"footer-company-address-country\" style=\"box-sizing: border-box;\">, Việt Nam</span></div><div id=\"iwr7d\" class=\"footer-company-phone\" style=\"box-sizing: border-box; width: 100%; margin-top: 6px; margin-bottom: 6px;\">0365186564</div><a href=\"https://nhakhoaphuongthao.vn/\" target=\"_blank\" id=\"i4o3m\" class=\"footer-company-url\" style=\"box-sizing: border-box; color: rgb(0, 0, 0); width: 100%; margin: 0px; text-decoration: none;\">https://nhakhoaphuongthao.vn/</a><div id=\"iebau\" class=\"footer-company-email\" style=\"box-sizing: border-box; width: 100%; margin-top: 6px; margin-bottom: 6px;\"></div><div id=\"i99jl\" class=\"footer-company-zip-code\" style=\"box-sizing: border-box; width: 100%; margin-top: 6px; margin-bottom: 6px;\"></div></td></tr><tr id=\"ikpzr\" style=\"box-sizing: border-box; width: 100%; height: 100%; min-height: auto;\"><td style=\"box-sizing: border-box; vertical-align: top;\"><table id=\"ieqy4\" class=\"footer-company-manager\" style=\"box-sizing: border-box; margin: 0 auto; color: #666666; font-family: Arial; font-weight: normal; font-size: 13px; font-style: normal; position: relative; left: 0; width: fit-content; float: none;\"><tbody><tr><td style=\"vertical-align: top;\"><table href=\"https://test.ladizone.com/aimkt/email/unsubscribe?infor=[url_verify_user]\" target=\"_blank\" ondragstart=\"return false;\" id=\"ips88\" class=\"footer-company-manager-unsubscribe footer-unsubscribe\" style=\"box-sizing: border-box; width: fit-content; margin: 0 12px; display: unset; text-decoration: underline; color: #7fbdf9ff; font-size: 13px;\"><tbody><tr><td style=\"padding: 0px; vertical-align: top; white-space: nowrap; word-break: normal; border-collapse: collapse;\"><a href=\"https://test.ladizone.com/aimkt/email/unsubscribe?infor=[url_verify_user]\" target=\"_blank\" ondragstart=\"return false;\" id=\"ips88\" class=\"footer-company-manager-unsubscribe footer-unsubscribe\" style=\"box-sizing: border-box; width: fit-content; margin: 0px; display: unset; text-decoration: underline; color: rgb(127, 189, 249); font-size: 13px; white-space: nowrap; word-break: normal; border-collapse: collapse;\">Hủy đăng ký</a></td></tr></tbody></table></td><td style=\"vertical-align: top;\"><table href=\"https://test.ladizone.com/aimkt/email/category?infor=[url_verify_user]\" target=\"_blank\" ondragstart=\"return false;\" id=\"ii33c\" class=\"footer-company-manager-categoty footer-unsubscribe\" style=\"box-sizing: border-box; width: fit-content; margin: 0 12px; display: none; text-decoration: underline; color: #7fbdf9ff; font-size: 13px;\"><tbody><tr><td style=\"padding: 0px; vertical-align: top; white-space: nowrap; word-break: normal; border-collapse: collapse;\"><a href=\"https://test.ladizone.com/aimkt/email/category?infor=[url_verify_user]\" target=\"_blank\" ondragstart=\"return false;\" id=\"ii33c\" class=\"footer-company-manager-categoty footer-unsubscribe\" style=\"box-sizing: border-box; width: fit-content; margin: 0px; display: none; text-decoration: underline; color: rgb(127, 189, 249); font-size: 13px; white-space: nowrap; word-break: normal; border-collapse: collapse;\">Quản lý nhận tin</a></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></div><style>@media only screen and (min-width: 640px) {  table.ai-email-section-3>tbody>tr>td>div,table.ai-email-section-2>tbody>tr>td>div,table.ai-email-section-1>tbody>tr>td>div,table.ai-email-section-12>tbody>tr>td>div,table.ai-email-section-21>tbody>tr>td>div {    display: table-cell !important;    width: auto !important;  }  table.ai-email-section-3>tbody>tr>td>div {    max-width: 200px !important;  }  table.ai-email-section-2>tbody>tr>td>div {    max-width: 300px !important;  }}</style><!--[endif]----></body>";
            mailDetails.Body = mailDetails.Body.Replace("{{Code}}", code);
            mailDetails.Body = mailDetails.Body.Replace("{{Name}}", name);
            mailDetails.Body = mailDetails.Body.Replace("{{Day}}", day.ToString().PadLeft(2, '0'));
            mailDetails.Body = mailDetails.Body.Replace("{{Month}}", month.ToString().PadLeft(2, '0'));
            mailDetails.Body = mailDetails.Body.Replace("{{Year}}", year.ToString());
            mailDetails.Body = mailDetails.Body.Replace("{{Hour}}", hour.ToString().PadLeft(2, '0'));
            mailDetails.Body = mailDetails.Body.Replace("{{Minute}}", minute.ToString().PadLeft(2, '0'));
            mailDetails.Body = mailDetails.Body.Replace("{{Remind}}", remind);
            //mailDetails.Body = body;
            clientDetails.Send(mailDetails);
            return true;
        }
        public class SMSResponse
        {
            public string CodeResult { get; set; }
            public string CountRegenerate { get; set; }
            public string SMSID { get; set; }
        }
    }
}